---
title: useIndexedDB
description: 用于 IndexedDB KV 存取的 React Hook（支持跨 Tab 同步）
---

import { IndexedDBExample } from '@/components/examples';

# useIndexedDB

一个轻量的 IndexedDB KV Hook，适合把“某个 key 的值”作为 React 状态来使用。

特性：

- 默认使用 IndexedDB 的 structured clone 存储（可直接存对象）
- 跨 Tab 同步：同一 `key` 在其他 Tab 写入后，本 Tab 会自动刷新
- `value` 未加载/不存在时返回 `undefined`

## 在线演示

<IndexedDBExample />

## 基本用法

```tsx tab="React 函数组件"
import { useIndexedDB } from 'arrow-hooks'

function App() {
  const [value, setValue, removeValue, status] = useIndexedDB<string>('demo:key')

  if (!status.isSupported) return <p>当前环境不支持 IndexedDB</p>

  return (
    <div>
      <p>loading: {String(status.loading)}</p>
      <p>value: {value ?? '(empty)'}</p>

      <button onClick={() => setValue('hello')}>写入</button>
      <button onClick={() => removeValue()}>删除</button>
    </div>
  )
}
```

## API 参考

### 参数

| 参数 | 类型 | 默认值 | 描述 |
|------|------|--------|------|
| key | `IDBValidKey` | - | IndexedDB key |
| options | `CreateIndexedDBClientOptions` | `{}` | db/store/channel 等配置 |

### 返回值

返回 `[value, setValue, removeValue, status]`：

| 索引 | 类型 | 描述 |
|------|------|------|
| 0 | `T \| undefined` | 当前值（未加载/不存在为 `undefined`） |
| 1 | `(value: T) => Promise<void>` | 写入值 |
| 2 | `() => Promise<void>` | 删除值 |
| 3 | `{ loading; error; isSupported }` | 状态（`status`） |

