---
title: useResizeObserver
description: ç”¨äºç›‘å¬ DOM å…ƒç´ å°ºå¯¸å˜åŒ–çš„ React Hook
---

import { ResizeObserverExample } from '@/components/examples';

# useResizeObserver

ç”¨äºç›‘å¬ DOM å…ƒç´ å°ºå¯¸å˜åŒ–çš„ React Hookï¼ŒåŸºäº ResizeObserver APIï¼Œå½“å…ƒç´ çš„å°ºå¯¸å‘ç”Ÿå˜åŒ–æ—¶æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå¸¸ç”¨äºå“åº”å¼å¸ƒå±€ã€å›¾è¡¨è‡ªé€‚åº”ã€å®¹å™¨æŸ¥è¯¢ç­‰åœºæ™¯ã€‚

## åœ¨çº¿æ¼”ç¤º

<ResizeObserverExample />

## åŸºæœ¬ç”¨æ³•

```tsx tab="React å‡½æ•°ç»„ä»¶"
import { useResizeObserver } from 'arrow-hooks'
import { useRef, useState } from 'react'

function App() {
  const [elementSize, setElementSize] = useState({ width: 0, height: 0 })
  const resizableRef = useRef<HTMLDivElement>(null)

  useResizeObserver(resizableRef, (entry) => {
    const { width, height } = entry.contentRect
    setElementSize({ width, height })
  })

  return (
    <div style={{ padding: '1rem' }}>
      {/* å°ºå¯¸ä¿¡æ¯æ˜¾ç¤º */}
      <div style={{ marginBottom: '1rem' }}>
        <h4>ğŸ“ å°ºå¯¸ä¿¡æ¯</h4>
        <div style={{
          display: 'grid',
          gridTemplateColumns: 'repeat(2, 1fr)',
          gap: '0.5rem',
          marginBottom: '1rem'
        }}>
          <div style={{
            padding: '0.75rem',
            backgroundColor: '#f0f8ff',
            borderRadius: '4px',
            textAlign: 'center'
          }}>
            <div style={{ fontSize: '1.25rem', fontWeight: 'bold', color: '#1890ff' }}>
              {Math.round(elementSize.width)}px
            </div>
            <div style={{ fontSize: '0.875rem', color: '#666' }}>å®½åº¦</div>
          </div>
          <div style={{
            padding: '0.75rem',
            backgroundColor: '#f6ffed',
            borderRadius: '4px',
            textAlign: 'center'
          }}>
            <div style={{ fontSize: '1.25rem', fontWeight: 'bold', color: '#52c41a' }}>
              {Math.round(elementSize.height)}px
            </div>
            <div style={{ fontSize: '0.875rem', color: '#666' }}>é«˜åº¦</div>
          </div>
        </div>
      </div>

      {/* å¯è°ƒæ•´å¤§å°çš„å…ƒç´  */}
      <div>
        <h4>ğŸ“ å¯è°ƒæ•´å¤§å°çš„å…ƒç´ </h4>
        <div
          ref={resizableRef}
          style={{
            width: '300px',
            height: '200px',
            backgroundColor: '#f5f5f5',
            border: '2px solid #d9d9d9',
            borderRadius: '8px',
            resize: 'both',
            overflow: 'auto',
            padding: '1rem',
            display: 'flex',
            flexDirection: 'column',
            alignItems: 'center',
            justifyContent: 'center',
            textAlign: 'center',
            cursor: 'nw-resize'
          }}
        >
          <div style={{ fontSize: '1.5rem', marginBottom: '0.5rem' }}>ğŸ“</div>
          <div style={{ fontWeight: 'bold', marginBottom: '0.5rem' }}>æ‹–æ‹½å³ä¸‹è§’è°ƒæ•´å¤§å°</div>
          <div style={{ fontSize: '0.875rem', color: '#666' }}>
            å½“å‰: {Math.round(elementSize.width)} Ã— {Math.round(elementSize.height)}
          </div>
        </div>
        <p style={{ fontSize: '0.875rem', color: '#666', margin: '0.5rem 0 0 0' }}>
          ğŸ’¡ æ‹–æ‹½å³ä¸‹è§’æ¥è°ƒæ•´å…ƒç´ å¤§å°ï¼Œè§‚å¯Ÿå°ºå¯¸å®æ—¶å˜åŒ–
        </p>
      </div>
    </div>
  )
}
```

## å…¶ä»–åœºæ™¯

### 1. å“åº”å¼å›¾è¡¨

æ ¹æ®å®¹å™¨å°ºå¯¸è‡ªåŠ¨è°ƒæ•´å›¾è¡¨å¤§å°ï¼š

```tsx
import { useResizeObserver } from 'arrow-hooks'
import { useRef, useState, useEffect } from 'react'

function ResponsiveChart() {
  const chartRef = useRef<HTMLDivElement>(null)
  const [chartSize, setChartSize] = useState({ width: 0, height: 0 })

  useResizeObserver(chartRef, (entry) => {
    const { width, height } = entry.contentRect
    setChartSize({ width, height })
  })

  useEffect(() => {
    if (chartSize.width > 0 && chartSize.height > 0) {
      // é‡æ–°æ¸²æŸ“å›¾è¡¨
      renderChart(chartSize.width, chartSize.height)
    }
  }, [chartSize])

  const renderChart = (width: number, height: number) => {
    // å›¾è¡¨æ¸²æŸ“é€»è¾‘
    console.log(`æ¸²æŸ“å›¾è¡¨: ${width} Ã— ${height}`)
  }

  return (
    <div
      ref={chartRef}
      style={{
        width: '100%',
        height: '400px',
        border: '1px solid #e0e0e0',
        borderRadius: '4px',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center'
      }}
    >
      <div style={{ textAlign: 'center' }}>
        <div style={{ fontSize: '1.5rem', marginBottom: '0.5rem' }}>ğŸ“Š</div>
        <div>å›¾è¡¨åŒºåŸŸ</div>
        <div style={{ fontSize: '0.875rem', color: '#666' }}>
          {Math.round(chartSize.width)} Ã— {Math.round(chartSize.height)}
        </div>
      </div>
    </div>
  )
}
```

### 2. è‡ªé€‚åº”æ–‡æœ¬å¤§å°

æ ¹æ®å®¹å™¨å¤§å°è°ƒæ•´æ–‡å­—å°ºå¯¸ï¼š

```tsx
import { useResizeObserver } from 'arrow-hooks'
import { useRef, useState, useMemo } from 'react'

function AdaptiveText({ text }: { text: string }) {
  const textRef = useRef<HTMLDivElement>(null)
  const [containerSize, setContainerSize] = useState({ width: 0, height: 0 })

  useResizeObserver(textRef, (entry) => {
    const { width, height } = entry.contentRect
    setContainerSize({ width, height })
  })

  const fontSize = useMemo(() => {
    const baseSize = 16
    const minSize = 12
    const maxSize = 48

    // æ ¹æ®å®¹å™¨å®½åº¦è®¡ç®—å­—ä½“å¤§å°
    const calculatedSize = Math.min(containerSize.width / text.length * 2,
                                   containerSize.height * 0.8)

    return Math.max(minSize, Math.min(maxSize, calculatedSize))
  }, [containerSize, text])

  return (
    <div
      ref={textRef}
      style={{
        width: '100%',
        height: '200px',
        border: '1px solid #e0e0e0',
        borderRadius: '4px',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        resize: 'both',
        overflow: 'hidden'
      }}
    >
      <div
        style={{
          fontSize: `${fontSize}px`,
          fontWeight: 'bold',
          textAlign: 'center',
          transition: 'font-size 0.2s ease'
        }}
      >
        {text}
      </div>
    </div>
  )
}
```


## API å‚è€ƒ

### å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
|------|------|--------|------|
| ref | RefObject\<T extends HTMLElement\> | - | è¦ç›‘å¬çš„å…ƒç´ å¼•ç”¨ |
| callback | ResizeCallback | - | å°ºå¯¸å˜åŒ–æ—¶çš„å›è°ƒå‡½æ•° |
| options | ResizeObserverOptions | undefined | è§‚å¯Ÿå™¨é…ç½®é€‰é¡¹ |

### å›è°ƒå‡½æ•°ç±»å‹

```tsx
type ResizeCallback = (entry: ResizeObserverEntry) => void
```

### ResizeObserverEntry å±æ€§

```tsx
interface ResizeObserverEntry {
  target: Element                    // ç›®æ ‡å…ƒç´ 
  contentRect: DOMRectReadOnly       // å†…å®¹åŒºåŸŸå°ºå¯¸
  borderBoxSize: ResizeObserverSize  // è¾¹æ¡†ç›’å°ºå¯¸
  contentBoxSize: ResizeObserverSize // å†…å®¹ç›’å°ºå¯¸
  devicePixelContentBoxSize: ResizeObserverSize // è®¾å¤‡åƒç´ å†…å®¹ç›’å°ºå¯¸
}

interface DOMRectReadOnly {
  width: number   // å®½åº¦
  height: number  // é«˜åº¦
  x: number       // X åæ ‡
  y: number       // Y åæ ‡
  top: number     // é¡¶éƒ¨è·ç¦»
  right: number   // å³ä¾§è·ç¦»
  bottom: number  // åº•éƒ¨è·ç¦»
  left: number    // å·¦ä¾§è·ç¦»
}
```

### ä½¿ç”¨ç¤ºä¾‹

```tsx
import { useResizeObserver } from 'arrow-hooks'

// åŸºç¡€ç”¨æ³•
useResizeObserver(elementRef, (entry) => {
  console.log('å°ºå¯¸å˜åŒ–:', entry.contentRect)
})

// è·å–è¯¦ç»†å°ºå¯¸ä¿¡æ¯
useResizeObserver(elementRef, (entry) => {
  const { width, height } = entry.contentRect
  const { x, y } = entry.contentRect

  console.log(`å°ºå¯¸: ${width} Ã— ${height}`)
  console.log(`ä½ç½®: (${x}, ${y})`)
})

// ä½¿ç”¨è¾¹æ¡†ç›’å°ºå¯¸
useResizeObserver(elementRef, (entry) => {
  if (entry.borderBoxSize) {
    const { inlineSize, blockSize } = entry.borderBoxSize[0]
    console.log(`è¾¹æ¡†ç›’å°ºå¯¸: ${inlineSize} Ã— ${blockSize}`)
  }
})
```

## æ³¨æ„äº‹é¡¹

- **æµè§ˆå™¨å…¼å®¹æ€§**: éœ€è¦ ResizeObserver API æ”¯æŒï¼Œç°ä»£æµè§ˆå™¨å‡æ”¯æŒ
- **æ€§èƒ½ä¼˜åŒ–**: ResizeObserver æ¯”ç›‘å¬ window resize äº‹ä»¶æ€§èƒ½æ›´å¥½ï¼Œåªç›‘å¬ç‰¹å®šå…ƒç´ 
- **å›è°ƒç¨³å®šæ€§**: å»ºè®®å°†å¤æ‚çš„å¤„ç†é€»è¾‘å°è£…åœ¨ useCallback ä¸­
- **é˜²æŠ–è€ƒè™‘**: å¯¹äºé¢‘ç¹å˜åŒ–çš„åœºæ™¯ï¼Œå¯ä»¥è€ƒè™‘åœ¨å›è°ƒä¸­æ·»åŠ é˜²æŠ–é€»è¾‘
- **å†…å­˜ç®¡ç†**: ç»„ä»¶å¸è½½æ—¶ä¼šè‡ªåŠ¨æ–­å¼€è§‚å¯Ÿå™¨è¿æ¥
- **å°ºå¯¸ä¿¡æ¯**: contentRect æä¾›çš„æ˜¯å†…å®¹åŒºåŸŸå°ºå¯¸ï¼Œä¸åŒ…æ‹¬è¾¹æ¡†å’Œæ»šåŠ¨æ¡
- **åˆå§‹åŒ–**: ç»„ä»¶æŒ‚è½½åä¼šç«‹å³è§¦å‘ä¸€æ¬¡å›è°ƒï¼Œè·å–åˆå§‹å°ºå¯¸